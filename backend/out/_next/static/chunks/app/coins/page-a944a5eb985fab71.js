(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[523],{572:e=>{e.exports={container:"coins_container__jPQNN",header:"coins_header__vO_Zr",backButton:"coins_backButton__hPpE_",title:"coins_title__3Ydob",loading:"coins_loading__w4HnG",error:"coins_error__SQE3E",success:"coins_success__drL8N",coinsBalance:"coins_coinsBalance__tZC2g",coinIcon:"coins_coinIcon__Midci",coinCount:"coins_coinCount__5CvjD",coinLabel:"coins_coinLabel__x6MZA",actionsContainer:"coins_actionsContainer__1ojFE",rewardCard:"coins_rewardCard__BNoxo",rewardHeader:"coins_rewardHeader__JpLt1",rewardIcon:"coins_rewardIcon__eexhp",rewardTitle:"coins_rewardTitle__YF_aA",rewardDescription:"coins_rewardDescription__Wbox8",errorMessage:"coins_errorMessage__C0bxo",nextClaimTime:"coins_nextClaimTime__pj_uH",claimButton:"coins_claimButton__P4qzt",adButton:"coins_adButton__jyLsU",buttonIcon:"coins_buttonIcon__xAC40",progressContainer:"coins_progressContainer__YhGzB",progressBar:"coins_progressBar__izLn7",progressText:"coins_progressText__X6Vws",activityButton:"coins_activityButton__J8HWP",coinsAvailable:"coins_coinsAvailable__o2LPY",smallCoinIcon:"coins_smallCoinIcon__ZiZHt"}},18976:(e,r,t)=>{Promise.resolve().then(t.bind(t,87895))},35695:(e,r,t)=>{"use strict";var a=t(18999);t.o(a,"useParams")&&t.d(r,{useParams:function(){return a.useParams}}),t.o(a,"usePathname")&&t.d(r,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(r,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(r,{useSearchParams:function(){return a.useSearchParams}})},53116:(e,r,t)=>{"use strict";t.d(r,{$P:()=>s,PZ:()=>d,Yv:()=>l,getUserCoins:()=>o,lD:()=>n,wA:()=>c,z$:()=>i});var a=t(72047);let o=async()=>{try{let e=localStorage.getItem("token");if(!e)throw Error("Authentication required");return await fetch("".concat("https://ebookaura.onrender.com/api","/coins"),{method:"GET",headers:{Authorization:"Bearer ".concat(e)}}).then(e=>{if(!e.ok)throw Error("Failed to get coin balance");return e.json()})}catch(e){throw console.error("Error getting user coins:",e),e}},s=async e=>{try{let r=localStorage.getItem("token");if(!r)throw Error("Authentication required");return await fetch("".concat("https://ebookaura.onrender.com/api","/coins/update-session"),{method:"POST",headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json"},body:JSON.stringify({sessionDuration:e})}).then(e=>{if(!e.ok)throw Error("Failed to update session time");return e.json()})}catch(e){throw console.error("Error updating session time:",e),e}},n=async()=>{try{let e=localStorage.getItem("token");if(!e)throw Error("Authentication required");return await fetch("".concat("https://ebookaura.onrender.com/api","/coins/session-status"),{method:"GET",headers:{Authorization:"Bearer ".concat(e)}}).then(e=>{if(!e.ok)throw Error("Failed to get session status");return e.json()})}catch(e){throw console.error("Error getting session status:",e),e}},i=async()=>{try{let e=localStorage.getItem("token");if(!e)throw Error("Authentication required");return await fetch("".concat("https://ebookaura.onrender.com/api","/coins/activity-reward"),{method:"POST",headers:{Authorization:"Bearer ".concat(e)}}).then(e=>e.ok?e.json():e.json().then(e=>{throw Error(e.message||"Failed to claim activity reward")}))}catch(e){throw console.error("Error claiming activity reward coins:",e),e}},c=async()=>{try{let e=localStorage.getItem("token");if(!e)throw Error("Authentication required");return await fetch("".concat("https://ebookaura.onrender.com/api","/coins/daily"),{method:"POST",headers:{Authorization:"Bearer ".concat(e)}}).then(e=>e.ok?e.json():e.json().then(e=>{throw Error(e.message||"Failed to claim daily coins")}))}catch(e){throw console.error("Error claiming daily coins:",e),e}},l=async()=>{try{let e=localStorage.getItem("token");if(!e)throw Error("Authentication required");return await fetch("".concat("https://ebookaura.onrender.com/api","/coins/daily-status"),{method:"GET",headers:{Authorization:"Bearer ".concat(e)}}).then(e=>{if(!e.ok)throw Error("Failed to check daily coins status");return e.json()})}catch(e){throw console.error("Error checking daily coins status:",e),e}},d=async e=>{try{let r=localStorage.getItem("token");if(!r)throw Error("Authentication required");return await (0,a.dw)("/users/check-purchase/".concat(e),{headers:{Authorization:"Bearer ".concat(r)}})}catch(e){throw console.error("Error checking book purchase:",e),e}}},74436:(e,r,t)=>{"use strict";t.d(r,{k5:()=>d});var a=t(12115),o={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},s=a.createContext&&a.createContext(o),n=["attr","size","title"];function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e}).apply(this,arguments)}function c(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,a)}return t}function l(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?c(Object(t),!0).forEach(function(r){var a,o,s;a=e,o=r,s=t[r],(o=function(e){var r=function(e,r){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,r||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==typeof r?r:r+""}(o))in a?Object.defineProperty(a,o,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[o]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function d(e){return r=>a.createElement(u,i({attr:l({},e.attr)},r),function e(r){return r&&r.map((r,t)=>a.createElement(r.tag,l({key:t},r.attr),e(r.child)))}(e.child))}function u(e){var r=r=>{var t,{attr:o,size:s,title:c}=e,d=function(e,r){if(null==e)return{};var t,a,o=function(e,r){if(null==e)return{};var t={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(r.indexOf(a)>=0)continue;t[a]=e[a]}return t}(e,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)t=s[a],!(r.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}(e,n),u=s||r.size||"1em";return r.className&&(t=r.className),e.className&&(t=(t?t+" ":"")+e.className),a.createElement("svg",i({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,o,d,{className:t,style:l(l({color:e.color||r.color},r.style),e.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),c&&a.createElement("title",null,c),e.children)};return void 0!==s?a.createElement(s.Consumer,null,e=>r(e)):r(o)}},87895:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>h});var a=t(95155),o=t(12115),s=t(35695),n=t(6874),i=t.n(n),c=t(29911),l=t(56068),d=t(572),u=t.n(d),m=t(53116);function h(){let{user:e,updateUserCoins:r}=(0,l.h)(),t=(0,s.useRouter)(),[n,d]=(0,o.useState)(!0),[h,w]=(0,o.useState)(!1),[p,y]=(0,o.useState)(!1),[_,f]=(0,o.useState)(""),[g,b]=(0,o.useState)(""),[v,j]=(0,o.useState)(""),[x,C]=(0,o.useState)(""),[N,E]=(0,o.useState)(null),[T,k]=(0,o.useState)(!1),[A,O]=(0,o.useState)(!1),[S,P]=(0,o.useState)({sessionTimeToday:0,requiredTime:60,hasClaimedReward:!1,progress:0,canClaimReward:!1,nextRewardTime:null,minutesAccumulated:0,coinsAvailable:0}),[B,I]=(0,o.useState)(null);(0,o.useEffect)(()=>(!T&&e?(D(),k(!0),R()):e||t.push("/login"),()=>{B&&clearInterval(B)}),[e,t,T]);let R=()=>{z(),I(setInterval(()=>{(0,m.$P)(30).then(e=>{P(r=>({...r,sessionTimeToday:e.sessionTimeToday,canClaimReward:e.canClaimReward,progress:Math.floor(e.sessionTimeToday%60/60*100),minutesAccumulated:e.minutesAccumulated||0,coinsAvailable:5*(e.minutesAccumulated||0)}))}).catch(e=>console.error("Error updating session time:",e))},3e4))},z=async()=>{try{let e=await (0,m.lD)();e&&P({sessionTimeToday:e.sessionTimeToday||0,requiredTime:e.requiredTime||60,hasClaimedReward:!1,progress:e.progress||0,canClaimReward:e.canClaimReward||!1,nextRewardTime:null,minutesAccumulated:e.minutesAccumulated||0,coinsAvailable:e.coinsAvailable||0})}catch(e){console.error("Error fetching session status:",e)}},D=async()=>{d(!0),f("");try{let e=await (0,m.getUserCoins)();e&&"number"==typeof e.coins&&r(e.coins);let t=await (0,m.Yv)();t&&(O(t.hasClaimed),t.hasClaimed&&t.nextRewardTime?E(new Date(t.nextRewardTime)):E(null)),await z()}catch(e){console.error("Error fetching coins data:",e),f(e.message||"Failed to fetch coins data")}finally{d(!1)}},q=async()=>{w(!0),j(""),b("");try{let e=await (0,m.wA)();if(e&&"number"==typeof e.coins){r(e.coins),b("Successfully claimed ".concat(e.coinsAdded," daily coins!")),O(!0);let t=new Date;t.setHours(24,0,0,0),E(t)}}catch(e){console.error("Error claiming daily coins:",e),j(e.message||"Failed to claim daily coins"),e.response&&e.response.data&&e.response.data.nextReward&&(E(new Date(e.response.data.nextReward)),O(!0))}finally{w(!1)}},F=async()=>{y(!0),C(""),b("");try{let e=await (0,m.z$)();e&&"number"==typeof e.coins&&(r(e.coins),b("Successfully claimed ".concat(e.coinsAdded," coins for ").concat(e.minutesSpent," minute(s) of site activity!")),P(e=>({...e,hasClaimedReward:!1,sessionTimeToday:0,progress:0,canClaimReward:!1,minutesAccumulated:0,coinsAvailable:0})),setTimeout(()=>{b("")},5e3))}catch(e){console.error("Error claiming activity reward:",e),C(e.message||"Failed to claim activity reward"),z(),setTimeout(()=>{C("")},5e3)}finally{y(!1)}},L=e=>{let r=Math.floor(e/60),t=e%60;return"".concat(r,":").concat(t<10?"0":"").concat(t)};return n?(0,a.jsxs)("div",{className:u().container,children:[(0,a.jsxs)("div",{className:u().header,children:[(0,a.jsx)(i(),{href:"/",className:u().backButton,children:(0,a.jsx)(c.QVr,{})}),(0,a.jsx)("h1",{className:u().title,children:"My Coins"})]}),(0,a.jsx)("div",{className:u().loading,children:"Loading coins data..."})]}):(0,a.jsxs)("div",{className:u().container,children:[(0,a.jsxs)("div",{className:u().header,children:[(0,a.jsx)(i(),{href:"/",className:u().backButton,children:(0,a.jsx)(c.QVr,{})}),(0,a.jsx)("h1",{className:u().title,children:"My Coins"})]}),_&&(0,a.jsx)("div",{className:u().error,children:_}),g&&(0,a.jsx)("div",{className:u().success,children:g}),(0,a.jsxs)("div",{className:u().coinsBalance,children:[(0,a.jsx)(c.cEG,{className:u().coinIcon}),(0,a.jsx)("span",{className:u().coinCount,children:(null==e?void 0:e.coins)||0}),(0,a.jsx)("span",{className:u().coinLabel,children:"coins"})]}),(0,a.jsxs)("div",{className:u().actionsContainer,children:[(0,a.jsxs)("div",{className:u().rewardCard,children:[(0,a.jsxs)("div",{className:u().rewardHeader,children:[(0,a.jsx)(c.itz,{className:u().rewardIcon}),(0,a.jsx)("h2",{className:u().rewardTitle,children:"Daily Reward"})]}),(0,a.jsx)("p",{className:u().rewardDescription,children:"Claim your daily reward of 10 coins. Come back every day!"}),v&&(0,a.jsx)("p",{className:u().errorMessage,children:v}),A&&N&&(0,a.jsxs)("p",{className:u().nextClaimTime,children:["Next claim available at: ",N?N.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):""]}),(0,a.jsxs)("button",{className:"".concat(u().claimButton," ").concat(A?u().disabledButton:""),onClick:q,disabled:h||A,children:[h?"Claiming...":A?"Already Claimed Today":"Claim 10 Coins",(0,a.jsx)(c.Wp,{className:u().buttonIcon})]})]}),(0,a.jsxs)("div",{className:u().rewardCard,children:[(0,a.jsxs)("div",{className:u().rewardHeader,children:[(0,a.jsx)(c.w_X,{className:u().rewardIcon}),(0,a.jsx)("h2",{className:u().rewardTitle,children:"Time Rewards"})]}),(0,a.jsx)("p",{className:u().rewardDescription,children:"Get 5 coin for each minute you spend on our site. Claim anytime!"}),x&&(0,a.jsx)("p",{className:u().errorMessage,children:x}),(0,a.jsxs)("div",{className:u().progressContainer,children:[(0,a.jsx)("div",{className:u().progressBar,style:{width:"".concat(S.progress,"%")}}),(0,a.jsxs)("span",{className:u().progressText,children:[L(S.sessionTimeToday%60)," / ",L(60)," to next coin"]})]}),(0,a.jsxs)("p",{className:u().coinsAvailable,children:[(0,a.jsx)(c.cEG,{className:u().smallCoinIcon}),(0,a.jsxs)("span",{children:[S.coinsAvailable," coins available to claim"]})]}),(0,a.jsxs)("button",{className:"".concat(u().activityButton," ").concat(S.canClaimReward?"":u().disabledButton),onClick:F,disabled:p||!S.canClaimReward,children:[p?"Claiming...":S.canClaimReward?"Claim ".concat(S.coinsAvailable," Coin").concat(1!==S.coinsAvailable?"s":""):"Keep browsing for coins",(0,a.jsx)(c.w_X,{className:u().buttonIcon})]})]})]})]})}}},e=>{var r=r=>e(e.s=r);e.O(0,[6671,6711,6874,6068,8441,1684,7358],()=>r(18976)),_N_E=e.O()}]);