(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[511],{3955:(o,e,r)=>{Promise.resolve().then(r.t.bind(r,69243,23)),Promise.resolve().then(r.bind(r,62146)),Promise.resolve().then(r.bind(r,10255)),Promise.resolve().then(r.bind(r,89777))},89777:(o,e,r)=>{"use strict";r.d(e,{default:()=>a});var n=r(95155),i=r(12115),d=r(35695),s=r(55028),l=r(56068);let t=(0,s.default)(()=>Promise.all([r.e(6215),r.e(6711),r.e(5479),r.e(8087),r.e(6874),r.e(7628),r.e(8190)]).then(r.bind(r,13275)),{loadableGenerated:{webpack:()=>[13275]},ssr:!1,loading:()=>(0,n.jsxs)("div",{className:"loading-container",children:[(0,n.jsx)("div",{className:"loading-spinner"}),(0,n.jsx)("p",{children:"Loading book information..."})]})});function a(o){let{params:e}=o,[r,s]=(0,i.useState)((null==e?void 0:e.id)||""),[a,c]=(0,i.useState)(!0),[p,u]=(0,i.useState)(""),x=(0,d.useParams)(),h=(0,d.usePathname)(),g=(0,d.useRouter)(),{user:b,isLoggedIn:f}=(0,l.h)();return((0,i.useEffect)(()=>{console.log("BookClientWrapper - Auth State:",{isLoggedIn:f,user:b?"exists":"null",userId:null==b?void 0:b.id,coins:null==b?void 0:b.coins})},[b,f]),(0,i.useEffect)(()=>{(()=>{if(null==e?void 0:e.id){if("not-found"===e.id){console.error("Not-found ID detected, showing error UI"),u("Book not found. Please try searching for another book."),c(!1);return}console.log("Using server-provided ID:",e.id),s(e.id),c(!1);return}if(null==x?void 0:x.id){if("not-found"===x.id){console.error("Not-found ID detected, showing error UI"),u("Book not found. Please try searching for another book."),c(!1);return}console.log("Using client params ID:",x.id),s(x.id),c(!1);return}try{let o=h.split("/"),e="";for(let r=0;r<o.length;r++)if("books"===o[r]&&r+1<o.length){e=o[r+1];break}console.log("Path parts:",o),console.log("Raw ID from path:",e);let r=(null==e?void 0:e.endsWith("/"))?e.substring(0,e.length-1):e,n=null==r?void 0:r.split("?")[0];if(console.log("Clean ID after processing:",n),n&&""!==n&&"not-found"!==n&&"undefined"!==n)console.log("Using ID extracted from path:",n),s(n);else throw Error("Could not extract valid book ID from path")}catch(o){console.error("Error determining book ID:",o),u("Could not determine which book to display")}finally{c(!1)}})()},[e,x,h,g]),a)?(0,n.jsxs)("div",{className:"loading-container",children:[(0,n.jsx)("div",{className:"loading-spinner"}),(0,n.jsx)("p",{children:"Loading book information..."})]}):p?(0,n.jsxs)("div",{className:"error-container",style:{padding:"20px",maxWidth:"800px",margin:"0 auto",backgroundColor:"#f8f9fa",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[(0,n.jsx)("h2",{style:{color:"#dc3545"},children:"Error"}),(0,n.jsx)("p",{children:p}),(0,n.jsxs)("div",{style:{margin:"20px 0",padding:"10px",backgroundColor:"#e9ecef",borderRadius:"4px",fontSize:"14px",display:"none"},children:[(0,n.jsx)("h3",{children:"Debug Information"}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Current Path:"})," ",h]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Server Params ID:"})," ",(null==e?void 0:e.id)||"none"]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Client Params ID:"})," ",(null==x?void 0:x.id)||"none"]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Extracted Book ID:"})," ",r||"none"]})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:"10px",marginTop:"20px"},children:[(0,n.jsx)("button",{onClick:()=>g.back(),style:{padding:"8px 16px",backgroundColor:"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Go Back"}),(0,n.jsx)("button",{onClick:()=>g.push("/search"),style:{padding:"8px 16px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Browse Books"}),(0,n.jsx)("button",{onClick:()=>window.location.reload(),style:{padding:"8px 16px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Reload Page"})]})]}):r&&"not-found"!==r?(0,n.jsx)(t,{id:r}):(0,n.jsxs)("div",{className:"error-container",style:{padding:"20px",maxWidth:"800px",margin:"0 auto",backgroundColor:"#f8f9fa",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[(0,n.jsx)("h2",{style:{color:"#dc3545"},children:"Book Not Found"}),(0,n.jsx)("p",{children:"The requested book could not be found or the ID is invalid."}),(0,n.jsxs)("div",{style:{margin:"20px 0",padding:"10px",backgroundColor:"#e9ecef",borderRadius:"4px",fontSize:"14px",display:"none"},children:[(0,n.jsx)("h3",{children:"Debug Information"}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Current Path:"})," ",h]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Server Params ID:"})," ",(null==e?void 0:e.id)||"none"]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Client Params ID:"})," ",(null==x?void 0:x.id)||"none"]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"Extracted Book ID:"})," ",r||"none"]})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:"10px",marginTop:"20px"},children:[(0,n.jsx)("button",{onClick:()=>g.back(),style:{padding:"8px 16px",backgroundColor:"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Go Back"}),(0,n.jsx)("button",{onClick:()=>g.push("/search"),style:{padding:"8px 16px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Browse Books"}),(0,n.jsx)("button",{onClick:()=>{let o=prompt("Enter a valid book ID to try:");o&&g.push("/books/".concat(o))},style:{padding:"8px 16px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Try Another ID"})]})]})}}},o=>{var e=e=>o(o.s=e);o.O(0,[7250,6068,8441,1684,7358],()=>e(3955)),_N_E=o.O()}]);