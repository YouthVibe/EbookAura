(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[481],{6750:(e,t,n)=>{Promise.resolve().then(n.bind(n,17029))},10868:e=>{e.exports={container:"plans_container__wpxuU",header:"plans_header__iQnsV",backButton:"plans_backButton__LftVj",title:"plans_title__TFIWG",loading:"plans_loading__RV3s8",error:"plans_error__n6XE9",success:"plans_success__XtaC3",coinsBalance:"plans_coinsBalance__spZrH",coinIcon:"plans_coinIcon__X3e0Y",coinCount:"plans_coinCount__TqL7H",coinLabel:"plans_coinLabel__BGhR3",getCoinsButton:"plans_getCoinsButton__p79Ku",currentSubscription:"plans_currentSubscription__RBUoe",subscriptionHeader:"plans_subscriptionHeader__SSoM4",crownIcon:"plans_crownIcon__ZcuGw",subscriptionDetails:"plans_subscriptionDetails__mNoZA",subscriptionActions:"plans_subscriptionActions__iJsuB",nonCancelableNotice:"plans_nonCancelableNotice__S8O3G",infoIcon:"plans_infoIcon__w9ZpH",settingsButton:"plans_settingsButton__wMEh_",nonRefundableWarning:"plans_nonRefundableWarning__qL__H",warningIcon:"plans_warningIcon__qgOc_",plansContainer:"plans_plansContainer__CZsXr",planCard:"plans_planCard__fwUHw",popularPlan:"plans_popularPlan__lAzEA",popularBadge:"plans_popularBadge__f2VF4",planName:"plans_planName__Azr3k",planDescription:"plans_planDescription__zqb7Y",planPrice:"plans_planPrice__wGyOe",planCoinIcon:"plans_planCoinIcon__oEoAC",priceValue:"plans_priceValue__tSgSp",pricePeriod:"plans_pricePeriod__GytVi",featuresList:"plans_featuresList__ZaLYY",featureItem:"plans_featureItem__ozpH0",checkIcon:"plans_checkIcon__dBzlI",subscribeButton:"plans_subscribeButton__4o3Ye",disabledButton:"plans_disabledButton__v6DmT",insufficientCoins:"plans_insufficientCoins__K4D7u",noPlans:"plans_noPlans__G4vjo",modalOverlay:"plans_modalOverlay__gXxdL",modalContent:"plans_modalContent___rr_V",balanceInfo:"plans_balanceInfo__DIN_d",modalActions:"plans_modalActions__a1Bbg",cancelButton:"plans_cancelButton__JEz6Y",confirmButton:"plans_confirmButton__HoBWq",modalHeader:"plans_modalHeader__P5bTz",closeModalButton:"plans_closeModalButton__2Q0S3",modalBody:"plans_modalBody__wf7hF",balanceRow:"plans_balanceRow__Z1igP",warningHeader:"plans_warningHeader__hwZuR",activePlan:"plans_activePlan__TThI2",activePlanBadge:"plans_activePlanBadge____r9O",activePlanButton:"plans_activePlanButton__jGiHE",subscriptionNote:"plans_subscriptionNote__sy2My"}},17029:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>b});var s=n(95155),o=n(12115),a=n(35695),r=n(6874),c=n.n(r),i=n(29911),l=n(56068),u=n(10868),p=n.n(u),d=n(53116),h=n(46264);function b(){var e;let{user:t,updateUserCoins:n,isLoggedIn:r}=(0,l.h)(),u=(0,a.useRouter)(),[b,m]=(0,o.useState)(!0),[g,_]=(0,o.useState)(!1),[f,v]=(0,o.useState)([]),[y,w]=(0,o.useState)(null),[j,S]=(0,o.useState)(""),[k,x]=(0,o.useState)(""),[E,N]=(0,o.useState)(!1),[P,I]=(0,o.useState)(null),[A,C]=(0,o.useState)(!1),O=async()=>{m(!0),S("");try{let e=await (0,h.wQ)();e&&e.plans?(v(e.plans),console.log("Loaded ".concat(e.plans.length," subscription plans"))):e&&e.data&&(v(e.data),console.log("Loaded ".concat(e.data.length," subscription plans (alt format)")));try{console.log("Checking current subscription status...");let e=await (0,h.getCurrentSubscription)();console.log("Subscription check response:",e);let t=e&&!0===e.hasSubscription||e&&!0===e.active;t&&e.subscription?(w(e.subscription),C(!0),console.log("Active subscription found:",e.subscription)):t?(C(!0),console.log("User has an active subscription (basic details only)")):(console.log("No active subscription found"),C(!1),e&&e.wasExpired&&S("Your subscription has expired. Please renew to continue enjoying premium benefits."),w(null))}catch(e){console.error("Error fetching subscription:",e),C(!1)}try{let e=await (0,d.getUserCoins)();e&&"number"==typeof e.coins&&(n(e.coins),console.log("User has ".concat(e.coins," coins")))}catch(e){console.error("Error fetching coin balance:",e)}}catch(e){console.error("Error initializing plans page:",e),S(e.message||"Failed to load subscription plans")}finally{m(!1)}};(0,o.useEffect)(()=>{r?O():u.push("/login?redirect=plans")},[r,u]);let B=async()=>{if(P){_(!0),S(""),x("");try{console.log("Attempting to purchase plan: ".concat(P.name));let e={planId:P._id,paymentMethod:"coins"};console.log("Purchase data:",e);let t=await (0,h.D8)(e);if(console.log("Purchase result:",t),t&&t.success&&t.subscription){w(t.subscription),C(!0),x("Successfully subscribed to ".concat(P.name,"!"));try{let e=await (0,d.getUserCoins)();e&&"number"==typeof e.coins&&(n(e.coins),console.log("Updated user coins to: ".concat(e.coins)))}catch(e){console.error("Error updating coin balance after purchase:",e)}N(!1),document.body.style.overflow="",window.scrollTo(0,0)}else throw Error("Unexpected response format from subscription purchase")}catch(e){console.error("Error purchasing subscription:",e),e.message.includes("enough coins")?S("You don't have enough coins to purchase this plan. Please get more coins and try again."):e.message.includes("already has an active subscription")?(S("You already have an active subscription. Only one subscription can be active at a time."),C(!0)):S(e.message||"Failed to purchase subscription. Please try again later."),N(!1),document.body.style.overflow="",window.scrollTo(0,0)}finally{_(!1)}}},T=e=>{if(!r)return void u.push("/login?redirect=plans");if(A){S("You already have an active subscription. Only one subscription can be active at a time."),window.scrollTo(0,0);return}if((null==t?void 0:t.coins)<e.price){S("You don't have enough coins to purchase this plan. You need ".concat(e.price-t.coins," more coins.")),window.scrollTo(0,0);return}I(e),N(!0),setTimeout(()=>{window.scrollTo(0,0),document.body.style.overflow="hidden"},10)},R=e=>{if(!e.duration)return"";let{value:t,unit:n}=e.duration;return 1===t?"".concat(t," ").concat(n.slice(0,-1)):"".concat(t," ").concat(n)},D=()=>{N(!1),document.body.style.overflow=""},L=e=>{if(!y||!y.plan)return A&&console.log("Using hasActiveSubscription state to determine active plan (no full subscription details available)"),!1;console.log("Checking if plan matches current subscription:",{planId:e._id,subscriptionPlan:y.plan});let t=("object"==typeof y.plan?y.plan._id:y.plan)===e._id;return t&&console.log('Plan "'.concat(e.name,'" is the active subscription')),t};return((0,o.useEffect)(()=>{(async()=>{if(r)try{console.log("Checking subscription status on mount/navigation...");let e=await (0,h.getCurrentSubscription)(),t=!0===e.hasSubscription||!0===e.active;console.log("Subscription status check result:",{isActive:t,response:e}),C(t),t&&e.subscription&&w(e.subscription)}catch(e){console.error("Error checking subscription status on mount:",e)}})()},[r]),b)?(0,s.jsxs)("div",{className:p().container,children:[(0,s.jsxs)("div",{className:p().header,children:[(0,s.jsx)(c(),{href:"/",className:p().backButton,children:(0,s.jsx)(i.QVr,{})}),(0,s.jsx)("h1",{className:p().title,children:"Subscription Plans"})]}),(0,s.jsx)("div",{className:p().loading,children:"Loading plans..."})]}):(0,s.jsxs)("div",{className:p().container,children:[(0,s.jsxs)("div",{className:p().header,children:[(0,s.jsx)(c(),{href:"/",className:p().backButton,children:(0,s.jsx)(i.QVr,{})}),(0,s.jsx)("h1",{className:p().title,children:"Subscription Plans"})]}),j&&(0,s.jsx)("div",{className:p().error,children:j}),k&&(0,s.jsx)("div",{className:p().success,children:k}),y&&(0,s.jsxs)("div",{className:p().currentSubscription,children:[(0,s.jsxs)("div",{className:p().subscriptionHeader,children:[(0,s.jsx)(i.Hu1,{className:p().crownIcon}),(0,s.jsx)("h2",{children:"Your Current Subscription"})]}),(0,s.jsxs)("div",{className:p().subscriptionDetails,children:[(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Plan:"})," ",(null==(e=y.plan)?void 0:e.name)||"Premium Plan"]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Status:"})," ",y.status]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Active Until:"})," ",new Date(y.endDate).toLocaleDateString()]})]}),(0,s.jsx)("div",{className:p().subscriptionActions,children:(0,s.jsxs)("p",{className:p().nonCancelableNotice,children:[(0,s.jsx)(i.__w,{className:p().infoIcon})," Subscriptions are non-refundable and cannot be canceled once purchased."]})})]}),A&&(0,s.jsxs)("div",{className:p().subscriptionNote,children:[(0,s.jsx)(i.__w,{className:p().infoIcon}),(0,s.jsx)("p",{children:"You already have an active subscription. Only one subscription can be active at a time."})]}),(0,s.jsxs)("div",{className:p().coinsBalance,children:[(0,s.jsx)(i.cEG,{className:p().coinIcon}),(0,s.jsx)("span",{className:p().coinCount,children:(null==t?void 0:t.coins)||0}),(0,s.jsx)("span",{className:p().coinLabel,children:"coins"}),(0,s.jsx)(c(),{href:"/coins",className:p().getCoinsButton,children:"Get More Coins"})]}),(0,s.jsx)("div",{className:p().plansContainer,children:f.length>0?f.map(e=>{var n,o,a,r,c,l;return(0,s.jsxs)("div",{className:"".concat(p().planCard," ").concat(e.isPopular?p().popularPlan:""," ").concat(L(e)?p().activePlan:""),children:[e.isPopular&&(0,s.jsx)("div",{className:p().popularBadge,children:"Most Popular"}),L(e)&&(0,s.jsx)("div",{className:p().activePlanBadge,children:"Your Active Plan"}),(0,s.jsx)("h2",{className:p().planName,children:e.name}),(0,s.jsx)("p",{className:p().planDescription,children:e.description}),(0,s.jsxs)("div",{className:p().planPrice,children:[(0,s.jsx)(i.cEG,{className:p().planCoinIcon}),(0,s.jsx)("span",{className:p().priceValue,children:e.price}),(0,s.jsxs)("span",{className:p().pricePeriod,children:["for ",R(e)]})]}),(0,s.jsxs)("ul",{className:p().featuresList,children:[null==(n=e.features)?void 0:n.map((e,t)=>(0,s.jsxs)("li",{className:p().featureItem,children:[(0,s.jsx)(i.CMH,{className:p().checkIcon}),e]},t)),(null==(o=e.benefits)?void 0:o.maxPremiumBooks)>0&&(0,s.jsxs)("li",{className:p().featureItem,children:[(0,s.jsx)(i.CMH,{className:p().checkIcon}),e.benefits.maxPremiumBooks===1/0?"Unlimited premium books":"".concat(e.benefits.maxPremiumBooks," premium books/month")]}),(null==(a=e.benefits)?void 0:a.offlineReading)&&(0,s.jsxs)("li",{className:p().featureItem,children:[(0,s.jsx)(i.CMH,{className:p().checkIcon}),"Offline reading"]}),(null==(r=e.benefits)?void 0:r.adFree)&&(0,s.jsxs)("li",{className:p().featureItem,children:[(0,s.jsx)(i.CMH,{className:p().checkIcon}),"Ad-free experience"]}),(null==(c=e.benefits)?void 0:c.earlyAccess)&&(0,s.jsxs)("li",{className:p().featureItem,children:[(0,s.jsx)(i.CMH,{className:p().checkIcon}),"Early access to new releases"]}),(null==(l=e.benefits)?void 0:l.exclusiveContent)&&(0,s.jsxs)("li",{className:p().featureItem,children:[(0,s.jsx)(i.CMH,{className:p().checkIcon}),"Exclusive content"]})]}),(0,s.jsx)("button",{className:"".concat(p().subscribeButton," ").concat(A?p().disabledButton:""," ").concat(L(e)?p().activePlanButton:""),onClick:()=>T(e),disabled:A,children:L(e)?"Current Plan":A?"Subscription Active":(null==t?void 0:t.coins)<e.price?"Need More Coins":"Subscribe Now"}),!A&&(null==t?void 0:t.coins)<e.price&&(0,s.jsxs)("p",{className:p().insufficientCoins,children:["You need ",e.price-t.coins," more coins"]})]},e._id)}):(0,s.jsxs)("div",{className:p().noPlans,children:[(0,s.jsx)(i.__w,{className:p().infoIcon}),(0,s.jsx)("p",{children:"No subscription plans are currently available."})]})}),E&&P&&(0,s.jsx)("div",{className:p().modalOverlay,children:(0,s.jsxs)("div",{className:p().modalContent,children:[(0,s.jsxs)("div",{className:p().modalHeader,children:[(0,s.jsx)("h2",{children:"Confirm Subscription"}),(0,s.jsx)("button",{className:p().closeModalButton,onClick:D,"aria-label":"Close modal",children:"✕"})]}),(0,s.jsxs)("div",{className:p().modalBody,children:[(0,s.jsxs)("p",{children:["You are about to subscribe to ",(0,s.jsx)("strong",{children:P.name}),"."]}),(0,s.jsxs)("p",{children:["This will cost ",(0,s.jsxs)("strong",{children:[P.price," coins"]})," from your balance."]}),(0,s.jsxs)("div",{className:p().balanceInfo,children:[(0,s.jsxs)("div",{className:p().balanceRow,children:[(0,s.jsx)("span",{children:"Current Balance:"}),(0,s.jsxs)("strong",{children:[null==t?void 0:t.coins," coins"]})]}),(0,s.jsxs)("div",{className:p().balanceRow,children:[(0,s.jsx)("span",{children:"Balance After:"}),(0,s.jsxs)("strong",{children:[(null==t?void 0:t.coins)-P.price," coins"]})]})]}),(0,s.jsxs)("div",{className:p().nonRefundableWarning,children:[(0,s.jsxs)("div",{className:p().warningHeader,children:[(0,s.jsx)(i.__w,{className:p().warningIcon}),(0,s.jsx)("p",{children:"Important Information"})]}),(0,s.jsx)("p",{children:"By purchasing this subscription, you acknowledge that:"}),(0,s.jsxs)("ul",{children:[(0,s.jsxs)("li",{children:["Subscriptions are ",(0,s.jsx)("strong",{children:"non-refundable"})]}),(0,s.jsxs)("li",{children:["Subscriptions ",(0,s.jsx)("strong",{children:"cannot be canceled"})," once purchased"]}),(0,s.jsx)("li",{children:"Your subscription will be active until the end date"})]})]})]}),(0,s.jsxs)("div",{className:p().modalActions,children:[(0,s.jsx)("button",{className:p().cancelButton,onClick:D,disabled:g,children:"Cancel"}),(0,s.jsx)("button",{className:p().confirmButton,onClick:B,disabled:g,children:g?"Processing...":"Confirm Purchase"})]})]})})]})}},17203:(e,t,n)=>{"use strict";n.d(t,{JR:()=>s,Sn:()=>o}),n(72047);let s="https://ebookaura.onrender.com/api",o={AUTH:{LOGIN:"".concat(s,"/auth/login"),REGISTER:"".concat(s,"/auth/register"),ME:"".concat(s,"/auth/me"),FORGOT_PASSWORD:"".concat(s,"/auth/forgot-password"),RESET_PASSWORD:e=>"".concat(s,"/auth/reset-password/").concat(e),VERIFY_EMAIL:"".concat(s,"/auth/verify-email")},BOOKS:{ALL:"".concat(s,"/books"),CATEGORIES:"".concat(s,"/books/categories"),TAGS:"".concat(s,"/books/tags"),DETAILS:e=>"".concat(s,"/books/").concat(e),PDF:e=>"".concat(s,"/books/pdf/").concat(e),PDF_CONTENT:e=>"".concat(s,"/books/pdf/").concat(e),DOWNLOAD:e=>"".concat(s,"/books/").concat(e,"/download"),REVIEWS:e=>"".concat(s,"/books/").concat(e,"/reviews"),RATING:e=>"".concat(s,"/books/").concat(e,"/rating"),ADD_REVIEW:e=>"".concat(s,"/books/").concat(e,"/reviews")},UPLOAD:{FILE:"".concat(s,"/upload"),PDF:"".concat(s,"/upload/pdf"),DELETE_FILE:e=>"".concat(s,"/upload/").concat(e),DELETE_BOOK:e=>"".concat(s,"/upload/book/").concat(e)},USER:{PROFILE:"".concat(s,"/users/profile"),UPDATE_PROFILE:"".concat(s,"/users/profile"),UPDATE_IMAGE:"".concat(s,"/users/profile/image"),BOOKMARKS:"".concat(s,"/users/bookmarks")},SUBSCRIPTIONS:{CURRENT:"".concat(s,"/subscriptions/current"),CHECK:"".concat(s,"/subscriptions/check"),CHECK_API:"".concat(s,"/subscriptions/check-api"),ACTIVATE:"".concat(s,"/subscriptions/activate"),DEACTIVATE:"".concat(s,"/subscriptions/deactivate")},API_KEYS:{GENERATE:"".concat(s,"/api-keys/generate"),CURRENT:"".concat(s,"/api-keys/current"),REVOKE:"".concat(s,"/api-keys/revoke"),VERIFY:"".concat(s,"/api-keys/verify")}}},35695:(e,t,n)=>{"use strict";var s=n(18999);n.o(s,"useParams")&&n.d(t,{useParams:function(){return s.useParams}}),n.o(s,"usePathname")&&n.d(t,{usePathname:function(){return s.usePathname}}),n.o(s,"useRouter")&&n.d(t,{useRouter:function(){return s.useRouter}}),n.o(s,"useSearchParams")&&n.d(t,{useSearchParams:function(){return s.useSearchParams}})},46264:(e,t,n)=>{"use strict";n.d(t,{D8:()=>i,_h:()=>c,checkSubscriptionWithApiKey:()=>u,getCurrentSubscription:()=>r,nV:()=>l,wQ:()=>a});var s=n(72047);n(17203);let o={PLANS:36e5,HISTORY:6e5},a=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{let t="subscription_plans",{shouldMakeCall:n,cachedData:a}=(0,s.UB)(t,o.PLANS,e);if(!n&&a)return a;let r=await (0,s.dw)("/subscriptions/plans");if(r){let e=r.plans||r.data||[],n={...r,plans:e};return(0,s.yt)(t,n),n}return r}catch(e){throw console.error("Error fetching subscription plans:",e),e}},r=async()=>{try{let e=localStorage.getItem("token");if(!e)return console.log("No authentication token found for subscription check"),{success:!1,hasSubscription:!1,message:"Not authenticated"};console.log("Checking current subscription status from server...");let t=await fetch("".concat("https://ebookaura.onrender.com/api","/subscriptions/current"),{method:"GET",headers:{Authorization:"Bearer ".concat(e)}});console.log("Subscription status API response status: ".concat(t.status));let n=await t.json();if(console.log("Subscription status API response:",n),t.ok){void 0===n.hasSubscription&&void 0!==n.active?n.hasSubscription=n.active:void 0===n.active&&void 0!==n.hasSubscription&&(n.active=n.hasSubscription);try{localStorage.setItem("subscriptionStatus",JSON.stringify({hasSubscription:n.hasSubscription,active:n.hasSubscription,planType:n.planType,expiresAt:n.expiresAt,timestamp:new Date().toISOString()})),console.log("Subscription status cached successfully")}catch(e){console.warn("Failed to cache subscription status:",e)}return n.success&&n.hasSubscription?console.log("User has an active subscription (".concat(n.planType||"unknown"," plan), expires: ").concat(n.expiresAt||"unknown")):console.log("User does not have an active subscription"),n}throw console.error("Subscription check failed with error:",n.message),Error(n.message||"Failed to check subscription status")}catch(e){console.error("Error checking subscription status:",e);try{let e=localStorage.getItem("subscriptionStatus");if(e){let t=JSON.parse(e),n=new Date(t.timestamp),s=new Date;if(s-n<3e5)return console.log("Using cached subscription status from",new Date(t.timestamp).toLocaleTimeString()),console.log("Cached subscription value:",t.hasSubscription?"Active":"Inactive"),{success:!0,hasSubscription:t.hasSubscription,active:t.hasSubscription,planType:t.planType,expiresAt:t.expiresAt,fromCache:!0};console.log("Cached subscription data is too old:",Math.round((s-n)/6e4),"minutes old")}else console.log("No cached subscription data found")}catch(e){console.error("Error reading cached subscription status:",e)}return{success:!1,hasSubscription:!1,active:!1,error:e.message||"Failed to check subscription status"}}},c=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{let t=localStorage.getItem("token");if(!t)throw Error("Authentication required");let n="subscription_history",{shouldMakeCall:a,cachedData:r}=(0,s.UB)(n,o.HISTORY,e);if(!a&&r)return r;let c=await (0,s.dw)("/subscriptions/history",{headers:{Authorization:"Bearer ".concat(t)}});return(0,s.yt)(n,c),c}catch(e){throw console.error("Error fetching subscription history:",e),e}},i=async e=>{try{let t=localStorage.getItem("token");if(!t)throw Error("Authentication required");if(console.log("Purchasing subscription with data:",e),!e.planId)throw Error("Plan ID is required");e.paymentMethod||(e.paymentMethod="coins");let n=await fetch("".concat("https://ebookaura.onrender.com/api","/subscriptions"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(e)});console.log("Subscription purchase API response status: ".concat(n.status));let s=await n.json();if(console.log("Subscription purchase API response:",s),!n.ok)throw Error(s.message||"Failed to purchase subscription");try{localStorage.removeItem("subscriptionStatus"),console.log("Cleared subscription cache after purchase")}catch(e){console.warn("Failed to clear subscription cache:",e)}return s}catch(e){throw console.error("Error purchasing subscription:",e),e}},l=async(e,t)=>{try{let n=localStorage.getItem("token");if(!n)throw Error("Authentication required");let o=await (0,s.TA)("/subscriptions/".concat(e),t,{headers:{Authorization:"Bearer ".concat(n)}});return(0,s.yt)("current_subscription",null),(0,s.yt)("subscription_history",null),o}catch(e){throw console.error("Error updating subscription:",e),e}},u=async e=>{try{if(!e)throw console.error("checkSubscriptionWithApiKey called without an API key"),Error("API key is required");console.log("Checking subscription status with API key: ".concat(e.substring(0,5),"..."));let t=await fetch("".concat("https://ebookaura.onrender.com/api","/subscriptions/check-api"),{method:"GET",headers:{"X-API-Key":e}});console.log("Subscription check API response status: ".concat(t.status));let n=await t.json();if(console.log("Subscription check API response:",n),t.ok)return void 0===n.hasSubscription&&void 0!==n.active&&(n.hasSubscription=n.active),n.success&&n.hasSubscription?console.log("API key has valid subscription - granting access"):console.log("API key does not have an active subscription"),n;throw console.error("Subscription check failed with error:",n.message),Error(n.message||"Failed to check subscription status")}catch(e){return console.error("Error checking subscription with API key:",e),{success:!1,hasSubscription:!1,active:!1,error:e.message||"Failed to check subscription status"}}}},53116:(e,t,n)=>{"use strict";n.d(t,{$P:()=>a,PZ:()=>u,Yv:()=>l,getUserCoins:()=>o,lD:()=>r,wA:()=>i,z$:()=>c});var s=n(72047);let o=async()=>{try{let e=localStorage.getItem("token");if(!e)throw Error("Authentication required");return await fetch("".concat("https://ebookaura.onrender.com/api","/coins"),{method:"GET",headers:{Authorization:"Bearer ".concat(e)}}).then(e=>{if(!e.ok)throw Error("Failed to get coin balance");return e.json()})}catch(e){throw console.error("Error getting user coins:",e),e}},a=async e=>{try{let t=localStorage.getItem("token");if(!t)throw Error("Authentication required");return await fetch("".concat("https://ebookaura.onrender.com/api","/coins/update-session"),{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({sessionDuration:e})}).then(e=>{if(!e.ok)throw Error("Failed to update session time");return e.json()})}catch(e){throw console.error("Error updating session time:",e),e}},r=async()=>{try{let e=localStorage.getItem("token");if(!e)throw Error("Authentication required");return await fetch("".concat("https://ebookaura.onrender.com/api","/coins/session-status"),{method:"GET",headers:{Authorization:"Bearer ".concat(e)}}).then(e=>{if(!e.ok)throw Error("Failed to get session status");return e.json()})}catch(e){throw console.error("Error getting session status:",e),e}},c=async()=>{try{let e=localStorage.getItem("token");if(!e)throw Error("Authentication required");return await fetch("".concat("https://ebookaura.onrender.com/api","/coins/activity-reward"),{method:"POST",headers:{Authorization:"Bearer ".concat(e)}}).then(e=>e.ok?e.json():e.json().then(e=>{throw Error(e.message||"Failed to claim activity reward")}))}catch(e){throw console.error("Error claiming activity reward coins:",e),e}},i=async()=>{try{let e=localStorage.getItem("token");if(!e)throw Error("Authentication required");return await fetch("".concat("https://ebookaura.onrender.com/api","/coins/daily"),{method:"POST",headers:{Authorization:"Bearer ".concat(e)}}).then(e=>e.ok?e.json():e.json().then(e=>{throw Error(e.message||"Failed to claim daily coins")}))}catch(e){throw console.error("Error claiming daily coins:",e),e}},l=async()=>{try{let e=localStorage.getItem("token");if(!e)throw Error("Authentication required");return await fetch("".concat("https://ebookaura.onrender.com/api","/coins/daily-status"),{method:"GET",headers:{Authorization:"Bearer ".concat(e)}}).then(e=>{if(!e.ok)throw Error("Failed to check daily coins status");return e.json()})}catch(e){throw console.error("Error checking daily coins status:",e),e}},u=async e=>{try{let t=localStorage.getItem("token");if(!t)throw Error("Authentication required");return await (0,s.dw)("/users/check-purchase/".concat(e),{headers:{Authorization:"Bearer ".concat(t)}})}catch(e){throw console.error("Error checking book purchase:",e),e}}},74436:(e,t,n)=>{"use strict";n.d(t,{k5:()=>u});var s=n(12115),o={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},a=s.createContext&&s.createContext(o),r=["attr","size","title"];function c(){return(c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e}).apply(this,arguments)}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,s)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach(function(t){var s,o,a;s=e,o=t,a=n[t],(o=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!=typeof s)return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(o))in s?Object.defineProperty(s,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):s[o]=a}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function u(e){return t=>s.createElement(p,c({attr:l({},e.attr)},t),function e(t){return t&&t.map((t,n)=>s.createElement(t.tag,l({key:n},t.attr),e(t.child)))}(e.child))}function p(e){var t=t=>{var n,{attr:o,size:a,title:i}=e,u=function(e,t){if(null==e)return{};var n,s,o=function(e,t){if(null==e)return{};var n={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;n[s]=e[s]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(s=0;s<a.length;s++)n=a[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,r),p=a||t.size||"1em";return t.className&&(n=t.className),e.className&&(n=(n?n+" ":"")+e.className),s.createElement("svg",c({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,o,u,{className:n,style:l(l({color:e.color||t.color},t.style),e.style),height:p,width:p,xmlns:"http://www.w3.org/2000/svg"}),i&&s.createElement("title",null,i),e.children)};return void 0!==a?s.createElement(a.Consumer,null,e=>t(e)):t(o)}}},e=>{var t=t=>e(e.s=t);e.O(0,[3247,6711,6874,6068,8441,1684,7358],()=>t(6750)),_N_E=e.O()}]);